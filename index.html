<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Monitoring Kualitas Udara</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
body { background:#0b0e14; font-family:Inter,sans-serif; color:#d8d9da }
.card-grafana{background:#181b1f;border:1px solid #26292e;border-radius:4px}
.nav-active{border-bottom:3px solid #3274d9;color:#3274d9}
.active-filter{background:#3274d9;color:white}
</style>
</head>

<body class="p-4 lg:p-8">
<div class="max-w-7xl mx-auto">

<header class="flex justify-between items-center mb-6 bg-[#111217] p-4 border border-[#26292e]">
  <h1 class="text-xl font-black text-white">
    MONITORING KUALITAS UDARA 
    <span class="text-[#3274d9] text-xs">Kelompok 11</span>
  </h1>
</header>

<!-- DASHBOARD -->
<div class="space-y-4">

<!-- DATA SENSOR -->
<div class="grid grid-cols-2 md:grid-cols-4 gap-4">
  <div class="card-grafana p-4">
    <p class="text-xs text-rose-400">Suhu</p>
    <h3 id="dash-temp" class="text-2xl font-black">-- °C</h3>
  </div>
  <div class="card-grafana p-4">
    <p class="text-xs text-cyan-400">Kelembapan</p>
    <h3 id="dash-hum" class="text-2xl font-black">-- %</h3>
  </div>
  <div class="card-grafana p-4">
    <p class="text-xs text-emerald-400">CO₂</p>
    <h3 id="dash-co2" class="text-2xl font-black">-- ppm</h3>
  </div>
  <div class="card-grafana p-4">
    <p class="text-xs text-amber-400">Debu</p>
    <h3 id="dash-dust" class="text-2xl font-black">-- µg/m³</h3>
  </div>
</div>

<!-- STATUS UDARA -->
<div class="card-grafana p-4">
  <p class="text-xs text-slate-400">Kondisi Udara</p>
  <h2 id="status-label" class="text-2xl font-black">MENUNGGU DATA...</h2>
  <p id="last-update" class="text-xs text-slate-500"></p>
</div>

<!-- FRAME UDARA BURUK -->
<div id="bad-air-frame" class="card-grafana p-4 hidden border border-rose-500">
  <p class="text-xs text-rose-400">⚠️ Peringatan</p>
  <h2 class="text-2xl font-black text-rose-500">
    KUALITAS UDARA BURUK
  </h2>
  <p class="text-xs text-slate-400 mt-1">
    Gunakan masker dan batasi aktivitas luar ruangan.
  </p>
</div>

</div>
</div>

<script>
// FIREBASE CONFIG
firebase.initializeApp({
  apiKey: "AIzaSyAD1QPvINjWitgo_Rrj44s47Pr4S1BU_lM",
  databaseURL: "https://monitoring-kualitas-udar-8ad9d-default-rtdb.asia-southeast1.firebasedatabase.app"
});

const db = firebase.database();

// LISTENER SENSOR
db.ref('log_sensor').limitToLast(1).on('child_added', snap => {
  const v = snap.val();
  if(!v) return;

  document.getElementById('dash-temp').textContent = `${v.suhu} °C`;
  document.getElementById('dash-hum').textContent  = `${v.kelembapan} %`;
  document.getElementById('dash-co2').textContent  = `${v.co2} ppm`;
  document.getElementById('dash-dust').textContent = `${v.debu} µg/m³`;

  const statusEl = document.getElementById('status-label');
  const badFrame = document.getElementById('bad-air-frame');
  const status   = v.status || "TIDAK DIKETAHUI";

  statusEl.textContent = `UDARA ${status}`;

  if(status === "BAIK"){
    statusEl.className = "text-2xl font-black text-emerald-400";
    badFrame.classList.add('hidden');
  }
  else if(status === "BURUK"){
    statusEl.className = "text-2xl font-black text-rose-500";
    badFrame.classList.remove('hidden');
  }
  else{
    statusEl.className = "text-2xl font-black text-slate-400";
    badFrame.classList.add('hidden');
  }

  document.getElementById('last-update').textContent =
    `Update ${new Date().toLocaleTimeString()}`;
});
</script>

</body>
</html>
